## 半连接队列，全连接队列

SYN flood攻击为什么工具半连接队列而不是全连接队列：

攻击方可以伪造多个ip进行请求，但不能伪造成对应ip进行响应。可以伪造多个ip请求syn，使服务器陷入维持很大的syn_recv状态的半连接队列，并因为接收不到ack而不断重传syn+ack暂用服务器资源。

如果希望攻击全连接队列那么就需要真正的建立连接，但服务器syn+ack会发送到伪造的ip处（因为恶意攻击者并不能修改服务器和路由的规则，这是必然发送到正确ip且无法控制的），所以无法实现。



在socket建立连接前，实际上就是tcp为socket建立了连接。连接从半连接队列到全连接队列，再到socket.accept()开始处理连接，连接才从全连接队列中移除。所以如果维护了连接但socket不对连接处理，或者处理很久那么全连接队列就会积压

我们对请求的处理和讨论平时都是在代码层面，也就是应用层，所以我觉得socket可以算是应用层协议，因为它依赖tcp/ip协议，并在代码层面中得到体现（代码运行起来就是应用，所以说应用层）。所以tcp的全连接队列满是发生在我们用redis之类的对连接拒绝之前。

但是如果我们是服务器的控制方，也就是服务的提供者，当然会处理所有接收到的请求（全连接队列中的请求都是会处理的）。所有说如果没有被攻击的话，全连接队列满了表示实际表示了后面的应用层代码处理不过来了，而在处理能力之内的话全连接队列一直都会是空的，所有正常情况下，全连接队列的存在对我们编写代码几乎是透明的，不用怎么考虑。我的意思是不论如何半连接队列和全连接队列是系统在控制，一定会给应用层合理的回复，也就是有tcp自己的控制机制。但如果对应SYN flood攻击而言其实也不会对应用层产生影响，也不由应用层进行控制或考虑。